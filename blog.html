<!DOCTYPE html>
<html lang="fr">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="Place des Experts est un cabinet d'expertise comptable situé à Hazebrouck et La Madeleine. Nous accompagnons les entreprises en comptabilité, fiscalité et gestion. Découvrez nos services !">
        
        <title>Place des Experts - Blog</title>
        <link rel="icon" href="./images/Logo_fond_blanc.webp" type="image/png">
        
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

        <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

        <link rel="preload" href="./style/blog.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">

        <meta property="og:title" content="Place des Experts - Cabinet d'expertise comptable">
        <meta property="og:description" content="Cabinet comptable à Hazebrouck et La Madeleine, spécialisé en comptabilité, fiscalité et gestion d'entreprise.">
        <meta property="og:image" content="https://www.placedesexperts.fr/images/Logo_fond_blanc.webp">
        <meta property="og:url" content="https://www.placedesexperts.fr">
        <meta property="og:type" content="website">
    </head>

    <body>

        <!-- Barre de navigation -->
        <nav class="navbar navbar-expand-lg navbar-light">
            <div class="container-fluid">
                <!-- Logo du site -->
                <a class="navbar-brand" href="./index.html">
                    <img src="./images/Logo_fond_blanc.webp" 
                        width="120" height="100"
                        alt="Logo"
                        class="logo-site"
                        style="width: 120px; height: auto;"
                        loading="eager"
                        decoding="async">
                </a>

                <!-- Bouton pour mobile -->
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Liens du menu -->
                <div class="collapse navbar-collapse" id="navbarNav" style="justify-content: center; padding-right: 120px;"> <!-- Ajouter padding-right -->
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="nav-link" href="./index.html">Accueil</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="./cabinet.html">Le cabinet</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="./expertises.html">Nos expertises</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="./secteurs.html">Nos secteurs d’activité</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="./blog.html">Blog</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="./outils.html">Nos outils</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="./contact.html">Contact</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <!-- Section sous le menu avec le rectangle bleu -->
        <section>
            <div class="container rounded text-white d-flex align-items-center position-relative p-5">
                <div class="row bulles">
                    <img src="./images/gouttes.png" 
                    width="80" height="60"
                    alt="Décoration graphique"
                    class="decoration-graphic"
                    loading="lazy"
                    decoding="async">
                    <!-- Colonne gauche : texte, titre et logos -->
                    <div class="col-lg-6">
                        <div class="text-container">
                        </br><h1 class="display-4">BLOG</h1></br>
                            <p class="lead">
                                Cette page est votre source d'informations incontournables pour la comptabilité et la gestion quotidienne de votre activité. </br></br>
                                
                                Explorez nos articles, régulièrement mis à jour, et rédigés par nos experts. Vous y trouverez les dernières actualités fiscales et comptables, des informations pour la gestion de votre activité, des conseils pratiques, des retours d'expérience, et bien d’autres sujets.</br></br> 
                                
                                Vous pouvez également suivre les actualités de notre cabinet sur notre compte LinkedIn : <a href="https://www.linkedin.com/company/place-des-experts/?viewAsMember=true" target="_blank" class="text-link">Place des Experts</a>.
                            </p>
                            
                        </div>
                    </div>
                    <!-- Colonne droite : image pleine largeur -->
                    <div class="col-lg-6 d-flex justify-content-center align-items-center">
                        <img src="./images/Blog.webp"
                        alt="Image d'accueil"
                        class="img-fluid2 rounded custom-image responsive_img"
                        style="width: 70%; max-width: 400px; height: auto;"
                        loading="lazy"
                        decoding="async">

                    </div> 
                </div>
            </div>
            
        </section>

        <!-- Barre de recherche avec icône de loupe -->
        <div class="search-bar-container d-flex align-items-center">
            <i class="bi bi-search search-icon"></i>
            <input type="text" id="search-input" placeholder="Rechercher dans les articles..." class="form-control">
        </div>

        <div id="blog-cards-container" class="blog-cards-list container"></div>
        <div id="pagination-container" class="pagination-container d-flex justify-content-center mt-4"></div>

        <!-- Bouton pour remonter en haut de la page -->
        <a href="#" class="scroll-to-top">
            <i class="bi bi-arrow-up-circle-fill"></i>
        </a>

        <!-- Script du Bouton pour remonter en haut de la page -->
        <script>
            // Afficher/Masquer le bouton selon le défilement
            window.addEventListener('scroll', function() {
                var scrollToTopButton = document.querySelector('.scroll-to-top');
                if (window.scrollY > 300) {
                    scrollToTopButton.classList.add('show');
                } else {
                    scrollToTopButton.classList.remove('show');
                }
            });

            // Remonter en haut de la page lorsqu'on clique sur le bouton
            document.querySelector('.scroll-to-top').addEventListener('click', function(e) {
                e.preventDefault();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });

        </script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

        <!--  Gestion des articles -->
        <script>
            const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQeYPB8TcxaqiZL2FUMsiHxLkpg6669WPPq3gzfgz16s-EYrMA8Q4NrzJODs2EFr1cuL3OsvRtMi0Nq/pub?output=csv';
        
            async function fetchCSV() {
                try {
                    const response = await fetch(csvUrl);
                    const data = await response.text();
        
                    const blogCardsContainer = document.getElementById('blog-cards-container');
                    blogCardsContainer.innerHTML = '';
        
                    // Analyser le CSV avec PapaParse
                    const parsedData = Papa.parse(data, {
                        header: true,
                        skipEmptyLines: true
                    });
        
                    // Nettoyer les clés des objets
                    const articlesData = parsedData.data.map(entry => {
                        const cleanedEntry = {};
                        Object.keys(entry).forEach(key => {
                            const cleanedKey = key.trim(); // Supprimer les espaces autour de la clé
                            cleanedEntry[cleanedKey] = entry[key].trim();
                        });
                        return cleanedEntry;
                    });

                    // Mettre à jour le stockage local avec les nouvelles données
                    localStorage.setItem('articlesData', JSON.stringify(articlesData));

                    // Restaurer la pagination et le défilement
                    const savedState = JSON.parse(localStorage.getItem('blogState'));
                    if (savedState) {
                        currentPage = savedState.currentPage || 1;
                        displayArticles(articlesData, currentPage);

                        // Restaurer la position de défilement après un délai pour permettre le rendu
                        setTimeout(() => {
                            window.scrollTo(0, savedState.scrollPosition || 0);
                        }, 100);
                    } else {
                        displayArticles(articlesData, 1);
                    }

        
                    // Fonction pour parser les dates au format DD/MM/YYYY
                    function parseDate(dateString) {
                        if (!dateString) return new Date(0);
                        const [day, month, year] = dateString.split('/');
                        return new Date(`${year}-${month}-${day}`);
                    }
        
                    // Trier les articles par date (du plus récent au plus ancien)
                    articlesData.sort((a, b) => {
                        const dateA = parseDate(a['Date de publication']);
                        const dateB = parseDate(b['Date de publication']);
                        return dateB - dateA;
                    });
        
                    displayArticles(articlesData, currentPage);

                } catch (error) {
                    console.error("Erreur lors de la récupération des articles :", error);
                }
            }

            let currentPage = 1;
            const articlesPerPage = 9;

            function displayArticles(articles, page) {
                const startIndex = (page - 1) * articlesPerPage;
                const endIndex = startIndex + articlesPerPage;

                const paginatedArticles = articles.slice(startIndex, endIndex);
                const blogCardsContainer = document.getElementById('blog-cards-container');
                blogCardsContainer.innerHTML = '';

                paginatedArticles.forEach((entry, index) => {
                    const title = entry['Titre'];
                    const author = entry["Auteur de l'article"];
                    const date = entry['Date de publication'];
                    const imageUrl = entry['Image principale'];
                    const content = entry["Texte d'introduction"];
                    const excerpt = content.split(' ').slice(0, 20).join(' ') + ' ...';

                    const cardHTML = `
                        <div class="blog-card">
                            <img id="blogImage${index}" class="blog-card-image" src="${imageUrl}" alt="${title}">
                            <div class="blog-card-content">
                                <h3>${title}</h3>
                                <p><em>Par ${author}, le ${date}</em></p>
                                <p class="excerpt">${excerpt}</p>
                                <div class="read-more-container">
                                    <a class="read-more" onclick="openArticle('${title.replace(/'/g, "\\'")}')">En savoir plus</a>
                                </div>
                            </div>
                        </div>
                    `;
                    blogCardsContainer.insertAdjacentHTML('beforeend', cardHTML);
                });

                createPagination(articles);
            }

            function createPagination(articles) {
                const paginationContainer = document.getElementById('pagination-container');
                paginationContainer.innerHTML = '';
                const totalPages = Math.ceil(articles.length / articlesPerPage);

                const paginationList = document.createElement('ul');
                paginationList.className = 'pagination justify-content-center flex-wrap';

                const addPageButton = (label, page, isActive = false, isDisabled = false) => {
                    const li = document.createElement('li');
                    li.className = `page-item ${isActive ? 'active' : ''} ${isDisabled ? 'disabled' : ''}`;

                    const button = document.createElement('button');
                    button.className = 'page-link';
                    button.innerText = label;
                    button.disabled = isDisabled;
                    if (!isDisabled) {
                        button.addEventListener('click', () => {
                            currentPage = page;
                            displayArticles(articles, currentPage);
                        });
                    }

                    li.appendChild(button);
                    paginationList.appendChild(li);
                };

                // Bouton "Première page"
                addPageButton('<<', 1, false, currentPage === 1);

                // Pages précédentes avec ellipses
                if (currentPage > 3) {
                    addPageButton('1', 1);
                    const li = document.createElement('li');
                    li.className = 'page-item disabled';
                    li.innerHTML = '<span class="page-link">...</span>';
                    paginationList.appendChild(li);
                }

                // Pages autour de la page actuelle
                for (let i = Math.max(1, currentPage - 2); i <= Math.min(totalPages, currentPage + 2); i++) {
                    addPageButton(i, i, currentPage === i);
                }

                // Pages suivantes avec ellipses
                if (currentPage < totalPages - 2) {
                    const li = document.createElement('li');
                    li.className = 'page-item disabled';
                    li.innerHTML = '<span class="page-link">...</span>';
                    paginationList.appendChild(li);
                    addPageButton(totalPages, totalPages);
                }

                // Bouton "Dernière page"
                addPageButton('>>', totalPages, false, currentPage === totalPages);

                paginationContainer.appendChild(paginationList);
            }



            function normalizeString(str) {
                return str
                    .normalize("NFD")
                    .replace(/[\u0300-\u036f]/g, "") // Supprime les accents
                    .replace(/’/g, "'") // Remplace les apostrophes courbes
                    .replace(/-/g, " ") // Remplace les tirets par des espaces
                    .replace(/[^a-zA-Z0-9\s]/g, "") // Supprime les caractères spéciaux
                    .toLowerCase()
                    .trim();
            }

            function openArticle(articleTitle) {
                const normalizedTitle = normalizeString(articleTitle);
                const encodedTitle = encodeURIComponent(normalizedTitle);

                // Sauvegarde de l'état de pagination et de défilement
                const state = {
                    currentPage: currentPage,
                    scrollPosition: window.scrollY
                };
                localStorage.setItem('blogState', JSON.stringify(state));

                // Redirection vers la page de l'article
                window.location.href = `article.html?title=${encodedTitle}`;
            }





        
            document.addEventListener('DOMContentLoaded', fetchCSV);
        </script>

        <!-- pagination dynamique depuis un fichier CSV -->
        <script>
            function filterArticles() {
            const searchInput = normalizeString(document.getElementById('search-input').value);
            const articlesData = JSON.parse(localStorage.getItem('articlesData')) || [];
            const filteredArticles = articlesData.filter(article => {
                const title = normalizeString(article['Titre'] || '');
                const author = normalizeString(article["Auteur de l'article"] || '');
                const content = normalizeString(article["Texte d'introduction"] || '');
                return title.includes(searchInput) || author.includes(searchInput) || content.includes(searchInput);
            });

            currentPage = 1; // Réinitialise à la première page
            displayArticles(filteredArticles, currentPage);

            // Affiche un message si aucun article trouvé
            if (filteredArticles.length === 0) {
                document.getElementById('blog-cards-container').innerHTML = `<p>Aucun article trouvé pour votre recherche.</p>`;
            }
         
            // Afficher les articles filtrés
            filteredArticles.forEach((entry, index) => {
                const title = entry['Titre'];
                const author = entry["Auteur de l'article"];
                const date = entry['Date de publication'];
                const imageUrl = entry['Image principale'];
                const content = entry["Texte d'introduction"];
                const excerpt = content.split(' ').slice(0, 20).join(' ') + '...';

                const cardHTML = `
                    <div class="blog-card">
                        <img id="blogImage${index}" class="blog-card-image" src="${imageUrl}" alt="${title}" onerror="this.src='./images/Nos expertises/Comptabilite╠ü/2-Vision moderne.png';">
                        <div class="blog-card-content">
                            <h3>${title}</h3>
                            <p><em>Par ${author}, le ${date}</em></p>
                            <p class="excerpt">${excerpt}</p>
                            <div class="read-more-container">
                                <a class="read-more" onclick="openArticle('${title.replace(/'/g, "\\'")}')">En savoir plus</a>
                            </div>
                        </div>
                    </div>
                `;

                blogCardsContainer.insertAdjacentHTML('beforeend', cardHTML);
            });

            // Afficher un message si aucun article n'est trouvé
            if (filteredArticles.length === 0) {
                blogCardsContainer.innerHTML = `<p>Aucun article trouvé pour votre recherche.</p>`;
            }
        }
            // Écouter les changements dans la barre de recherche
            document.getElementById('search-input').addEventListener('input', filterArticles);
        </script>

        <!-- Lien vers Bootstrap JavaScript -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        
    </body>
    
    <hr class="footer-separator">
    <footer class="footer">
        <div class="container">
            <ul class="services-list">
                <li style ="text-align: center;">Notre cabinet est inscrit à l’Ordre des experts-comptables Nord Pas de Calais et à la Compagnie des commissaires aux comptes de Douai.</li>
            </ul></br>
            <div class="row">
                <div class="footer-col">
                    <h3>Le cabinet</h3>
                    <ul class="footer-links">
                        <li><a href="./cabinet.html">Notre équipe</a></li>
                        <li><a href="./cabinet.html#valeurs">Nos valeurs</a></li>
                        <li><a href="./blog.html">Blog</a></li>
                        <li><a href="./iso.html">ISO 9001</a></li>
                        <li><a href="./contact.html#recrutement">Espace recrutement</a></li>
                        <li><a href="./mentions.html">Mentions légales</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h3>Nous retrouver</h3>
                    <ul class="footer-links">
                        <li><a href="https://www.linkedin.com/company/place-des-experts/?viewAsMember=true" target="_blank">LinkedIn</a></li>
                        <li><a href="https://www.instagram.com/placedesexperts/profilecard/?igsh=MTJ0YzkxNzA2NDBhZA==" target="_blank">Instagram</a></li>
                        <li><a href="https://www.facebook.com/profile.php?id=61558604020917" target="_blank">Facebook</a></li>
                        <li><a href="https://www.youtube.com/@PlacedesExperts" target="_blank">Youtube</a></li>
                        <li><a href="./contact.html#rdv">Prendre rendez-vous</a></li>
                        
                    </ul>
                </div>
                <div class="footer-col">
                    <h3>Prendre contact avec nous ?</h3>
                        <i class="bi bi-arrow-return-right" style="color:#245360;font-size: 50px;margin-right:10px;margin-top: 10px; vertical-align: middle;"></i><a class = "btn btn-custom" style ="font-size:1.8rem; border-radius:10px;" href="./contact.html">Contact</a>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 Tous droits réservés | SARL Place des Experts</p>
            </div>
        </div>
    </footer>
    
</html>